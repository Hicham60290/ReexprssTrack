# üì¶ ReExpressTrack - Platform de R√©exp√©dition de Colis

<div align="center">

![ReExpressTrack Logo](https://via.placeholder.com/200x80/4F46E5/FFFFFF?text=ReExpressTrack)

**Plateforme moderne de r√©exp√©dition de colis pour les DOM-TOM**

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Node](https://img.shields.io/badge/node-%3E%3D20.0.0-brightgreen.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/typescript-5.6-blue.svg)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/react-18.2-61dafb.svg)](https://reactjs.org/)

</div>

---

## üéØ Vue d'ensemble

ReExpressTrack est une plateforme compl√®te de gestion de r√©exp√©dition de colis, con√ßue sp√©cialement pour les r√©sidents des DOM-TOM. Elle permet de:

‚úÖ Recevoir des colis en France m√©tropolitaine  
‚úÖ Suivre vos colis en temps r√©el  
‚úÖ Obtenir des devis automatiques multi-transporteurs  
‚úÖ G√©rer vos paiements de fa√ßon s√©curis√©e  
‚úÖ Consulter vos statistiques et √©conomies  

---

## üèóÔ∏è Architecture

### Stack Technologique

#### Backend
- **Runtime:** Node.js 20+
- **Framework:** Fastify
- **ORM:** Prisma
- **Database:** PostgreSQL 16
- **Cache:** Redis 7
- **Storage:** MinIO (S3-compatible)
- **Queue:** BullMQ
- **Auth:** JWT
- **Validation:** Zod
- **Payments:** Stripe
- **Tracking:** 17Track API

#### Frontend
- **Framework:** React 18 + TypeScript
- **Build Tool:** Vite
- **State:** Zustand + React Query
- **UI:** TailwindCSS + Shadcn/ui
- **Forms:** React Hook Form + Zod
- **Charts:** Recharts
- **i18n:** i18next

#### DevOps
- **Containerization:** Docker + Docker Compose
- **Reverse Proxy:** Nginx
- **CI/CD:** GitHub Actions
- **Monitoring:** Prometheus + Grafana (optionnel)

---

## üìÇ Structure du Projet

```
reexpresstrack/
‚îú‚îÄ‚îÄ backend/                    # API Backend
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules/           # Modules fonctionnels
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/         # Authentification ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/        # Gestion utilisateurs ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ packages/     # Gestion colis ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ quotes/       # Gestion devis ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payments/     # Gestion paiements ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/        # Administration ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ support/      # Support client ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common/           # Code partag√©
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/    # Connexion DB
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cache/       # Redis
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queue/       # BullMQ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage/     # MinIO
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middleware/  # Middlewares
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/          # Configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ server.ts        # Point d'entr√©e
‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma    # Sch√©ma de base
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/      # Migrations
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seed.ts          # Donn√©es de test
‚îÇ   ‚îú‚îÄ‚îÄ tests/               # Tests
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ frontend/                  # Application React
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ features/         # Features par module
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ quotes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shared/          # Code partag√©
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/ # Composants UI
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/      # Hooks custom
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/      # Utilitaires
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/      # Types TS
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.tsx
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ nginx/                    # Configuration Nginx
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml        # Stack compl√®te
‚îú‚îÄ‚îÄ .env.example             # Variables d'environnement
‚îî‚îÄ‚îÄ README.md                # Ce fichier
```

---

## üöÄ Installation et D√©marrage

### Pr√©requis

- **Node.js** >= 20.0.0
- **npm** >= 10.0.0
- **Docker** >= 24.0.0 (optionnel mais recommand√©)
- **Docker Compose** >= 2.20.0 (optionnel)

### Option 1: Avec Docker (Recommand√©)

#### 1. Cloner le repository
```bash
git clone https://github.com/votre-username/reexpresstrack.git
cd reexpresstrack
```

#### 2. Configurer l'environnement
```bash
# Backend
cp backend/.env.example backend/.env
# √âditer backend/.env avec vos valeurs

# Frontend
cp frontend/.env.example frontend/.env
# √âditer frontend/.env avec vos valeurs
```

#### 3. D√©marrer l'infrastructure compl√®te
```bash
# D√©marrer tous les services
docker-compose up -d

# V√©rifier que tout fonctionne
docker-compose ps

# Voir les logs
docker-compose logs -f
```

#### 4. Initialiser la base de donn√©es
```bash
# Acc√©der au container backend
docker-compose exec backend sh

# G√©n√©rer le client Prisma
npm run prisma:generate

# Lancer les migrations
npm run prisma:migrate

# (Optionnel) Ajouter des donn√©es de test
npm run prisma:seed
```

#### 5. Acc√©der aux services

| Service | URL | Credentials |
|---------|-----|-------------|
| Frontend | http://localhost:5173 | - |
| Backend API | http://localhost:3000 | - |
| API Docs | http://localhost:3000/docs | - |
| Adminer (DB) | http://localhost:8080 | postgres/postgres |
| Redis Commander | http://localhost:8081 | - |
| MinIO Console | http://localhost:9001 | minioadmin/minioadmin |

### Option 2: Installation Locale (Sans Docker)

#### 1. Installer PostgreSQL
```bash
# Ubuntu/Debian
sudo apt install postgresql postgresql-contrib

# macOS (avec Homebrew)
brew install postgresql@16

# Cr√©er la base de donn√©es
psql -U postgres
CREATE DATABASE reexpresstrack;
\q
```

#### 2. Installer Redis
```bash
# Ubuntu/Debian
sudo apt install redis-server

# macOS
brew install redis

# D√©marrer Redis
redis-server
```

#### 3. Installer MinIO (optionnel)
```bash
# T√©l√©charger MinIO
wget https://dl.min.io/server/minio/release/linux-amd64/minio
chmod +x minio

# D√©marrer MinIO
./minio server ./data --console-address ":9001"
```

#### 4. Installer les d√©pendances

```bash
# Backend
cd backend
npm install
npm run prisma:generate
npm run prisma:migrate
npm run dev

# Frontend (dans un autre terminal)
cd frontend
npm install
npm run dev
```

---

## üîß Configuration

### Variables d'Environnement Backend

Voir le fichier `backend/.env.example` pour la liste compl√®te.

Variables essentielles:
```env
DATABASE_URL="postgresql://user:pass@localhost:5432/reexpresstrack"
JWT_SECRET="votre-secret-jwt-super-securise"
STRIPE_SECRET_KEY="sk_test_..."
TRACK17_API_KEY="votre-cle-17track"
```

### Variables d'Environnement Frontend

```env
VITE_API_URL=http://localhost:3000/api/v1
VITE_STRIPE_PUBLIC_KEY=pk_test_...
```

---

## üìö API Documentation

### Swagger UI

Une documentation interactive compl√®te est disponible √† l'adresse:
```
http://localhost:3000/docs
```

### Exemples de Requ√™tes

#### Inscription
```bash
curl -X POST http://localhost:3000/api/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "MotDePasse123!",
    "firstName": "Jean",
    "lastName": "Dupont"
  }'
```

#### Connexion
```bash
curl -X POST http://localhost:3000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "MotDePasse123!"
  }'
```

#### R√©cup√©rer les colis (authentifi√©)
```bash
curl -X GET http://localhost:3000/api/v1/packages \
  -H "Authorization: Bearer VOTRE_ACCESS_TOKEN"
```

---

## üß™ Tests

### Backend

```bash
cd backend

# Tests unitaires
npm test

# Tests avec coverage
npm run test:coverage

# Tests e2e
npm run test:e2e
```

### Frontend

```bash
cd frontend

# Tests unitaires
npm test

# Tests avec UI
npm run test:ui

# Tests e2e (Playwright)
npm run test:e2e
```

---

## üóÑÔ∏è Base de Donn√©es

### Sch√©ma

Le sch√©ma complet est d√©fini dans `backend/prisma/schema.prisma`.

Tables principales:
- `users` - Utilisateurs
- `profiles` - Profils utilisateurs
- `french_addresses` - Adresses fran√ßaises
- `packages` - Colis
- `quotes` - Devis
- `payments` - Paiements
- `subscriptions` - Abonnements
- `tracking_events` - √âv√©nements de suivi
- `notifications` - Notifications
- `audit_logs` - Logs d'audit

### Migrations

```bash
# Cr√©er une nouvelle migration
npm run prisma:migrate -- --name add_new_feature

# Appliquer les migrations
npm run prisma:migrate

# R√©initialiser la base
npm run prisma:migrate:reset
```

### Prisma Studio

Interface graphique pour explorer la base de donn√©es:
```bash
npm run prisma:studio
```

---

## üîê S√©curit√©

### Authentification

- JWT avec tokens d'acc√®s (15min) et refresh (7j)
- Tokens de refresh stock√©s dans Redis
- Rate limiting sur toutes les routes
- Hachage bcrypt pour les mots de passe

### Protection des Donn√©es

- Chiffrement HTTPS obligatoire en production
- Headers de s√©curit√© avec Helmet
- Protection CSRF
- Validation stricte avec Zod
- Audit logs pour toutes les actions sensibles

### Bonnes Pratiques

- Ne jamais commiter les fichiers `.env`
- Utiliser des secrets forts (>32 caract√®res)
- Activer 2FA pour les comptes admin
- Revoir r√©guli√®rement les logs d'audit
- Mettre √† jour les d√©pendances r√©guli√®rement

---

## üìä Monitoring (Optionnel)

### Prometheus + Grafana

Vous pouvez ajouter du monitoring en ajoutant ces services au `docker-compose.yml`:

```yaml
prometheus:
  image: prom/prometheus
  ports:
    - "9090:9090"
  volumes:
    - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml

grafana:
  image: grafana/grafana
  ports:
    - "3001:3000"
  environment:
    - GF_SECURITY_ADMIN_PASSWORD=admin
```

---

## üö¢ D√©ploiement en Production

### VPS (Recommand√© pour d√©buter)

#### 1. Pr√©parer le serveur
```bash
# Se connecter au VPS
ssh user@your-server.com

# Installer Docker
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER

# Installer Docker Compose
sudo apt install docker-compose
```

#### 2. D√©ployer l'application
```bash
# Cloner le repo
git clone https://github.com/votre-username/reexpresstrack.git
cd reexpresstrack

# Configurer l'environnement
cp backend/.env.example backend/.env
# √âditer avec vos valeurs de production

# D√©marrer les services
docker-compose -f docker-compose.prod.yml up -d

# V√©rifier
docker-compose ps
```

#### 3. Configurer le domaine

```bash
# Installer Certbot pour SSL
sudo apt install certbot python3-certbot-nginx

# Obtenir un certificat SSL
sudo certbot --nginx -d votredomaine.com -d www.votredomaine.com
```

### Kubernetes (Pour la scalabilit√©)

Des manifests Kubernetes sont disponibles dans le dossier `k8s/`.

```bash
kubectl apply -f k8s/
```

---

## üêõ Debugging

### Logs Backend

```bash
# Voir tous les logs
docker-compose logs -f backend

# Logs en temps r√©el d'un service sp√©cifique
docker-compose logs -f postgres
```

### Acc√©der √† la base de donn√©es

```bash
# Via Adminer
http://localhost:8080

# Via psql
docker-compose exec postgres psql -U postgres -d reexpresstrack
```

### Vider le cache Redis

```bash
# Via Redis Commander
http://localhost:8081

# Via CLI
docker-compose exec redis redis-cli
> AUTH redis_password
> FLUSHALL
```

---

## üìà Roadmap

### Backend (100% ‚úÖ)
- [x] Architecture de base
- [x] Authentification JWT
- [x] Module Users (profils, adresses, KYC)
- [x] Module Packages (colis, photos, tracking)
- [x] Module Quotes (devis multi-transporteurs, PDF)
- [x] Module Payments (Stripe, webhooks, remboursements)
- [x] Module Admin (dashboard, gestion compl√®te)
- [x] Module Support (tickets, messagerie)
- [x] Int√©gration 17Track API
- [x] Int√©gration Stripe compl√®te

### Frontend (√Ä venir)
- [ ] Interface utilisateur React
- [ ] Dashboard client
- [ ] Dashboard admin
- [ ] Interface support
- [ ] Notifications temps r√©el (WebSocket)
- [ ] Progressive Web App (PWA)

### Futur
- [ ] Syst√®me de parrainage
- [ ] IA pour d√©tection contenu colis
- [ ] App mobile React Native
- [ ] Tests automatis√©s (Jest, Playwright)

---

## ü§ù Contribution

Les contributions sont les bienvenues ! Voici comment participer:

1. Fork le projet
2. Cr√©er une branche feature (`git checkout -b feature/AmazingFeature`)
3. Commit vos changements (`git commit -m 'Add AmazingFeature'`)
4. Push vers la branche (`git push origin feature/AmazingFeature`)
5. Ouvrir une Pull Request

### Guidelines

- Suivre les conventions de code (ESLint + Prettier)
- √âcrire des tests pour les nouvelles features
- Mettre √† jour la documentation
- Garder les commits atomiques et descriptifs

---

## üìù License

Ce projet est sous licence MIT. Voir le fichier [LICENSE](LICENSE) pour plus de d√©tails.

---

## üë• Auteurs

- **Votre Nom** - *Travail initial* - [VotreGitHub](https://github.com/votre-username)

---

## üôè Remerciements

- [Fastify](https://www.fastify.io/) pour le framework backend
- [Prisma](https://www.prisma.io/) pour l'ORM
- [React](https://reactjs.org/) pour le framework frontend
- [Stripe](https://stripe.com/) pour les paiements
- [17Track](https://www.17track.net/) pour le suivi de colis

---

## üìû Support

Pour toute question ou probl√®me:

- üìß Email: support@reexpresstrack.com
- üí¨ Discord: [Rejoindre notre serveur](https://discord.gg/reexpresstrack)
- üêõ Issues: [GitHub Issues](https://github.com/votre-username/reexpresstrack/issues)

---

<div align="center">

**Fait avec ‚ù§Ô∏è pour les DOM-TOM**

[Site Web](https://reexpresstrack.com) ‚Ä¢ [Documentation](https://docs.reexpresstrack.com) ‚Ä¢ [Blog](https://blog.reexpresstrack.com)

</div>
